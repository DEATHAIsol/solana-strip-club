// List of banned words and phrases
const bannedWords = [
  // Investment/Trading Scam Terms
  'pump and dump',
  'pump & dump',
  'pump n dump',
  'pumpndump',
  'p&d',
  'pnd',
  'pump scheme',
  'pumping scheme',
  'dumping tokens',
  'token dump',
  't0ken dump',
  'tokn dump',
  'price manipulation',
  'pr1ce manipulation',
  'market manipulation',
  'mrkt manipulation',
  'fake volume',
  'fak3 volume',
  'fkvolume',
  'wash trading',
  'wash trade',
  'wash tr4de',
  'insider trading',
  'ins1der trading',
  'price fixing',
  'pr1ce f1xing',
  'artificial pump',
  'art1ficial pump',
  'coordinated pump',
  'coord pump',
  'coordinated dump',
  'coord dump',
  'bot trading',
  'b0t trading',
  'trading bot',
  'tr4ding b0t',
  'price bot',
  'pr1ce b0t',
  'token manipulation',
  't0ken manip',
  'price spoofing',
  'pr1ce sp00f',
  'layering',
  'l4yering',
  'front running',
  'frontrun',
  'fr0ntrun',
  'back running',
  'backrun',
  'b4ckrun',
  'sandwich attack',
  'sandwich atk',
  's4ndwich',
  'flash loan attack',
  'flashloan',
  'fl4shl0an',
  'mev bot',
  'm3v b0t',
  'sniping bot',
  'snip3 b0t',
  'buy wall',
  'buywall',
  'sell wall',
  'sellwall',
  'fake order',
  'fakeorder',
  'f4ke 0rder',
  'fake buy',
  'fakebuy',
  'f4ke buy',
  'fake sell',
  'fakesell',
  'f4ke sell',
  'market maker manipulation',
  'mm manipulation',
  'stop loss hunting',
  'sl hunting',
  'whale games',
  'wh4le games',
  'price suppression',
  'pr1ce suppress',

  // Streaming/Content Scam Terms
  'fake stream',
  'fakestream',
  'f4ke str34m',
  'fake livestream',
  'fake live stream',
  'fakelivestream',
  'f4ke l1ve',
  'recorded stream',
  'recordedstream',
  'rec0rded',
  'pre recorded',
  'prerecorded',
  'pr3recorded',
  'loop stream',
  'loopstream',
  'l00p str34m',
  'looped video',
  'loopedvideo',
  'l00ped',
  'recycled stream',
  'recycledstream',
  'recycled content',
  'recycledcontent',
  'stolen stream',
  'stolenstream',
  'st0len str34m',
  'stolen content',
  'stolencontent',
  'st0len c0ntent',
  'fake live',
  'fakelive',
  'f4ke l1ve',
  'not live',
  'notlive',
  'n0t l1ve',
  'bot viewers',
  'botviewers',
  'b0t v1ewers',
  'view botting',
  'viewbotting',
  'v1ew b0tting',
  'fake viewers',
  'fakeviewers',
  'f4ke v1ewers',
  'viewer manipulation',
  'viewermanip',
  'v1ewer man1p',
  'engagement manipulation',
  'engagementmanip',
  'fake chat',
  'fakechat',
  'f4ke ch4t',
  'bot chat',
  'botchat',
  'b0t ch4t',
  'automated chat',
  'automatedchat',
  'aut0 ch4t',
  'chat manipulation',
  'chatmanip',
  'ch4t man1p',
  'fake interaction',
  'fakeinteraction',
  'f4ke 1nteract',
  'fake donation',
  'fakedonation',
  'f4ke d0nation',
  'donation scam',
  'donationscam',
  'd0nation sc4m',
  'tip scam',
  'tipscam',
  't1p sc4m',
  'tip manipulation',
  'tipmanip',
  't1p man1p',
  'fake tips',
  'faketips',
  'f4ke t1ps',
  'tip botting',
  'tipbotting',
  't1p b0tting',
  'fake tipping',
  'faketipping',
  'f4ke t1pping',
  'tip farming',
  'tipfarming',
  't1p f4rming',
  'tip baiting',
  'tipbaiting',
  't1p b4iting',
  'stream recording',
  'streamrecording',
  'str34m rec',
  'recorded footage',
  'recordedfootage',
  'rec0rded f00t',
  'old footage',
  'oldfootage',
  '0ld f00t',
  'reused footage',
  'reusedfootage',
  'reused f00t',
  'impersonator',
  'impers0nator',
  '1mpersonat0r',
  'fake streamer',
  'fakestreamer',
  'f4ke str34mer',
  'streamer impersonation',
  'streamerimpersonation',
  'str34mer 1mp',
  'stolen identity',
  'stolenidentity',
  'st0len 1d',
  'identity theft',
  'identitytheft',
  '1dentity th3ft',
  'fake performance',
  'fakeperformance',
  'f4ke perf',
  'performance scam',
  'performancescam',
  'perf sc4m',

  // Project Red Flags
  'rug pull',
  'rugpull',
  'rugpul',
  'rug pul',
  'rugpool',
  'rug pool',
  'rugp00l',
  'r u g',
  'rugg',
  'rugged',
  'rugging',
  'soft rug',
  'softrug',
  's0ft rug',
  'slow rug',
  'slowrug',
  'sl0w rug',
  'stealth rug',
  'stealthrug',
  'st34lth rug',
  'exit scam',
  'exitscam',
  'ex1t sc4m',
  'honeypot',
  'honey pot',
  'honeypott',
  'h0neypot',
  'h0ney p0t',
  'ponzi',
  'p0nzi',
  'p0nz1',
  'ponz1',
  'pyramid scheme',
  'mlm scheme',
  'quick rich',
  'get rich quick',
  'guaranteed profit',
  'guaranteed return',
  '100x guaranteed',
  'easy money',
  'double your money',
  'triple your money',
  'multiply your investment',
  
  // Token/Contract Issues
  'liquidity pull',
  'liquidity pulled',
  'no liquidity',
  'fake contract',
  'contract scam',
  'malicious contract',
  'backdoor',
  'hidden mint',
  'infinite mint',
  'mint exploit',
  'ownership not renounced',
  'unrenounced contract',
  'contract vulnerability',
  'vulnerable contract',
  'unstable contract',
  'unaudited contract',
  'copy paste contract',
  'stolen contract',
  'hidden fee',
  'excessive fee',
  'tax scam',
  'high tax',
  'reflection scam',
  'rebase scam',
  
  // Team/Developer Red Flags
  'fake team',
  'anonymous team',
  'unknown team',
  'hidden team',
  'fake kyc',
  'no kyc',
  'fake doxx',
  'undoxxed team',
  'ghost developer',
  'ghost developers',
  'fake developer',
  'untrusted developer',
  'untrusted developers',
  'unverified developer',
  'unverified developers',
  'team wallet',
  'dev wallet',
  'insider wallet',
  'whale wallet',
  
  // Marketing/Community Red Flags
  'fake marketing',
  'bot marketing',
  'paid shills',
  'paid promotion',
  'undisclosed promotion',
  'fake partnership',
  'fake partnerships',
  'fake collaboration',
  'fake announcement',
  'fake news',
  'fake ama',
  'fake verification',
  'fake audit',
  'fake certificate',
  'fake endorsement',
  'fake influencer',
  'paid influencer',
  'bought followers',
  'fake followers',
  'fake community',
  'bot community',
  'toxic community',
  'fake engagement',
  'fake volume',
  'fake trading',
  'fake listing',
  'fake exchange',
  'unregistered exchange',
  'unlicensed exchange',
  
  // Project Status Red Flags
  'dead project',
  'abandoned project',
  'inactive project',
  'no development',
  'delayed development',
  'fake roadmap',
  'missed deadline',
  'broken promise',
  'empty promise',
  'false promise',
  'misleading roadmap',
  'unrealistic timeline',
  'unrealistic promise',
  'unrealistic promises',
  'no utility',
  'fake utility',
  'no use case',
  'weak use case',
  'copied project',
  'clone project',
  'fork scam',
  'fake fork',
  'unauthorized fork',
  
  // Common Scam Phrases
  'too good to be true',
  'act fast',
  'act now',
  'limited time',
  'exclusive offer',
  'private sale',
  'presale scam',
  'whitelist scam',
  'allocation scam',
  'investment opportunity',
  'guaranteed opportunity',
  'once in a lifetime',
  'dont miss out',
  'last chance',
  'urgent investment',
  'secret project',
  'hidden gem',
  'next moonshot',
  'easy moonshot',
  'guaranteed moonshot',
  // Add more banned words here

  // Additional Variations
  'scamm',
  'sc4m',
  'sc4mm',
  'skam',
  'sk4m',
  'scaam',
  'sc4am',
  'scamming',
  'sc4mming',
  'scammed',
  'sc4mmed',
  'scammer',
  'sc4mmer',
  'scamr',
  'sc4mr',
  'scummy',
  'scummi',
  'scummie',
  'sketchy',
  'sketch',
  'sketchi',
  'suspicious',
  'sus',
  'suss',
  'susss',
  'susssy',
  'shady',
  'sh4dy',
  'shadi',
  'shaddy',
  'shaddi',
  'fake',
  'fak3',
  'f4ke',
  'phake',
  'ph4ke',
  'fayke',
  'fayk',
  'faek',
  'feke',
  'feyk',
  'manipulation',
  'manip',
  'man1p',
  'man1pulation',
  'manipul8',
  'man1pul8',
  'manipul8ion',
  'man1pul8ion',
  'exploit',
  'expl0it',
  'expl01t',
  'xploit',
  'xpl0it',
  'vulnerability',
  'vuln',
  'vulner',
  'vulnerab',
  'vulnrable',
  'vulnerable',
  'vuln3rable',
  'vuln3r4ble',
  'hack',
  'h4ck',
  'h4x',
  'hax',
  'h4xor',
  'haxor',
  'hacker',
  'h4cker',
  'haxor',
  'h4x0r',
  'malicious',
  'mal1cious',
  'm4licious',
  'malware',
  'm4lware',
  'malw4re',
  'backdoor',
  'b4ckdoor',
  'backd00r',
  'b4ckd00r',
  'exploit',
  'expl0it',
  'xploit',
  'xpl0it',
  'stealing',
  'st3aling',
  'ste4ling',
  'stolen',
  'st0len',
  'st0l3n',
  'theft',
  'th3ft',
  'th3f7',
  'thief',
  'th1ef',
  'th13f',
  'robbed',
  'r0bbed',
  'r0bb3d',
  'robbery',
  'r0bbery',
  'r0bb3ry',
  // Add more banned words here
];

export function moderateMessage(message: string): {
  isAllowed: boolean;
  moderatedMessage: string;
  reason?: string;
} {
  if (!message || typeof message !== 'string') {
    return {
      isAllowed: false,
      moderatedMessage: '',
      reason: 'Invalid message format'
    };
  }

  // Create regex pattern for banned words
  const bannedWordsRegex = new RegExp(
    bannedWords
      .map(word => word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')) // Escape special regex characters
      .join('|'),
    'gi'
  );

  try {
    // Check if message contains any banned words
    const containsBannedWord = bannedWordsRegex.test(message);
    
    if (containsBannedWord) {
      // Replace banned words with asterisks
      const moderatedMessage = message.replace(bannedWordsRegex, match => '*'.repeat(match.length));
      
      return {
        isAllowed: false,
        moderatedMessage,
        reason: 'Message contains inappropriate content'
      };
    }

    return {
      isAllowed: true,
      moderatedMessage: message
    };
  } catch (error) {
    console.error('Error moderating message:', error);
    return {
      isAllowed: false,
      moderatedMessage: '',
      reason: 'Error processing message'
    };
  }
} 